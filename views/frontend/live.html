<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Live TV | Power Sanctuary</title>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --bg: #020617;
      --card: #0b0f1a;
      --accent: #c5a059;
      --border: rgba(255, 255, 255, 0.08);
      --text: #f8fafc;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: var(--text); height: 100vh; display: flex; flex-direction: column; overflow: hidden; }

    /* --- TOP MENU BAR --- */
    .top-nav {
      background: var(--card); padding: 15px 20px;
      display: flex; justify-content: space-between; align-items: center;
      border-bottom: 1px solid var(--border); z-index: 1000;
    }
    .logo { font-weight: 800; color: var(--accent); font-size: 0.9rem; letter-spacing: 1px; }
    .nav-links { display: flex; gap: 20px; }
    .nav-links a { color: var(--text); text-decoration: none; font-size: 0.8rem; font-weight: 600; text-transform: uppercase; }
    .nav-links a.active { color: var(--accent); }

    /* --- MAIN BROADCAST AREA --- */
    .broadcast-container { flex: 1; display: flex; flex-direction: column; background: #000; overflow: hidden; }
    .main-screen { width: 100%; aspect-ratio: 16/9; background: #000; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
    
    .now-playing { padding: 15px 20px; background: var(--card); border-bottom: 1px solid var(--border); }
    .now-playing h2 { font-size: 1rem; color: var(--accent); }
    .now-playing p { font-size: 0.75rem; color: #64748b; margin-top: 4px; }

    /* --- CHANNELS LIST --- */
    .channel-section { background: var(--bg); flex: 1; overflow-y: auto; padding-bottom: 20px; }
    .section-label { padding: 20px; font-size: 0.7rem; font-weight: 800; color: #475569; text-transform: uppercase; letter-spacing: 2px; }
    
    .channel-grid { display: grid; grid-template-columns: 1fr; gap: 1px; background: var(--border); }
    .channel-card { 
      background: var(--card); padding: 15px 20px; 
      display: flex; align-items: center; gap: 15px; cursor: pointer; transition: 0.3s;
    }
    .channel-card:active { background: rgba(197, 160, 89, 0.1); }
    .channel-card.active { border-left: 4px solid var(--accent); background: rgba(197, 160, 89, 0.05); }
    
    .ch-thumb { width: 50px; height: 50px; background: #1e293b; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--accent); font-weight: 800; font-size: 0.7rem; }
    .ch-info h4 { font-size: 0.9rem; margin-bottom: 2px; }
    .ch-info p { font-size: 0.7rem; color: #64748b; }

    footer { padding: 20px; background: #000; text-align: center; border-top: 1px solid var(--border); }
    .architect-line { font-size: 0.7rem; color: #475569; }
    .architect-name { color: var(--accent); font-weight: 700; }
  </style>
</head>
<body>

  <nav class="top-nav">
    <div class="logo">PS HUB</div>
    <div class="nav-links">
      <a href="index.html">Home</a>
      <a href="live.html" class="active">Live</a>
      <a href="prayer.html">Prayer</a>
      <a href="giving.html">Giving</a>
    </div>
  </nav>

  <main class="broadcast-container">
    <div class="main-screen" id="player-area">
      <iframe id="tvFrame" src="" style="width:100%; height:100%; border:none;" allowfullscreen></iframe>
    </div>

    <div class="now-playing">
      <h2 id="currentChannelName">Loading Stream...</h2>
      <p id="currentStatus">‚óè Live Connection Established</p>
    </div>

    <section class="channel-section">
      <div class="section-label">Select Gospel Channel</div>
      <div class="channel-grid">
        
        <div id="main-ps-channel" class="channel-card active" onclick="loadCloudStream()">
          <div class="ch-thumb">PS HQ</div>
          <div class="ch-info"><h4>Power Sanctuary TV</h4><p>Main Church Broadcast</p></div>
        </div>

        <div class="channel-card" onclick="switchChannel('Dove TV', 'UCmE-u0n8R2m6S_n2mY0n1mQ', this, true)">
          <div class="ch-thumb">DOVE</div>
          <div class="ch-info"><h4>RCCG Dove TV</h4><p>Redemption Camp Live</p></div>
        </div>

        <div class="channel-card" onclick="switchChannel('Dunamis TV', 'UC70fLq48uXqDshfTndB5U2w', this, true)">
          <div class="ch-thumb">DTRD</div>
          <div class="ch-info"><h4>Dunamis TV</h4><p>Gospel Highway</p></div>
        </div>

      </div>
    </section>
  </main>

  <footer>
    <p class="architect-line">RCCG POWER SANCTUARY DIGITAL CONSOLE &copy; 2025</p>
    <p class="architect-line">Designed by <span class="architect-name">Oluwarotimi Sunday Temitope</span></p>
  </footer>

  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDew-adannENogn9S01WB5QY10Q11eJAy0",
      authDomain: "rccgpowersanctuaryarea.firebaseapp.com",
      projectId: "rccgpowersanctuaryarea",
      storageBucket: "rccgpowersanctuaryarea.firebasestorage.app",
      messagingSenderId: "189635943022",
      appId: "1:189635943022:web:daa6cace786eb3de9a247f"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    let currentCloudID = "";

    // LISTEN FOR LIVE UPDATES FROM DASHBOARD
    db.collection("church_settings").doc("stream").onSnapshot(doc => {
        if (doc.exists) {
            currentCloudID = doc.data().youtubeId;
            // Only update iframe if Power Sanctuary channel is active
            if(document.getElementById('main-ps-channel').classList.contains('active')) {
                loadCloudStream();
            }
        }
    });

    function loadCloudStream() {
        const iframe = document.getElementById('tvFrame');
        // Check if the ID is a full channel ID or a specific Video ID
        const src = currentCloudID.startsWith('UC') 
            ? `https://www.youtube.com/embed/live_stream?channel=${currentCloudID}&autoplay=1`
            : `https://www.youtube.com/embed/${currentCloudID}?autoplay=1`;
        
        iframe.src = src;
        document.getElementById('currentChannelName').innerText = "Power Sanctuary Live";
        document.querySelectorAll('.channel-card').forEach(c => c.classList.remove('active'));
        document.getElementById('main-ps-channel').classList.add('active');
    }

    function switchChannel(name, id, element, isChannelID) {
      const iframe = document.getElementById('tvFrame');
      iframe.src = isChannelID 
        ? `https://www.youtube.com/embed/live_stream?channel=${id}&autoplay=1`
        : `https://www.youtube.com/embed/${id}?autoplay=1`;
      
      document.getElementById('currentChannelName').innerText = name;
      document.querySelectorAll('.channel-card').forEach(card => card.classList.remove('active'));
      element.classList.add('active');
    }
  </script>
</body>
            </html>
